// global variablesvar objTimeOut=1;//browser sniffervar agt=navigator.userAgent.toLowerCase();var is_mac    = (agt.indexOf("mac")!=-1);var is_major  = parseInt(navigator.appVersion);var msie_vers_start = agt.indexOf("msie")+5;var msie_real_vers = parseFloat(agt.substring(msie_vers_start, msie_vers_start+3));var is_linux  = (agt.indexOf("inux")!=-1);var is_nav    = ((agt.indexOf('mozilla')!=-1) && (agt.indexOf('spoofer')==-1) && (agt.indexOf('compatible') == -1) && (agt.indexOf('opera')==-1) && (agt.indexOf('webtv')==-1));var is_nav6   = (is_nav && (agt.indexOf('netscape6') != -1));var is_nav4up = (is_nav && (is_major >= 4));var is_nav41up = (is_nav && (is_major >= 4));var is_ie     = (agt.indexOf("msie") != -1);var is_ie3    = (is_ie && (is_major < 4));var is_ie4    = (is_ie && (is_major == 4) && (msie_real_vers < 5));var is_ie4up  = (is_ie  && (is_major >= 4));var is_ie5up  = (is_ie  && !is_ie3 && !is_ie4);var is_aol    = (agt.indexOf("aol") != -1);var is_aol4   = (is_aol && is_ie3);function show(id) {	if (document.all){		document.all[id].style.visibility='visible';}	else if (document.layers){		document.layers[id].visibility='show';}	else		document.getElementById(id).style.visibility='visible';}function hide(id) {	if (document.all) {		document.all[id].style.visibility='hidden'; }	else if (document.layers) {		document.layers[id].visibility='hide'; }	else		document.getElementById(id).style.visibility='hidden';}function bgChange(id, color){	if (document.all)	{	document.all[id].style.backgroundColor=color;	}	else if (document.layers)	{	document.layers[id].bgColor=color;	}}function toggleOption(state){	if(state){		if (document.all){	 		if(document.all.contactForm) 				{ 				hide('contactForm'); 				}  		}		else if (document.layers) {			if(document.contactForm)  				{  				hide('contactForm');				} 		} 	} 	else {		if (document.all){	 		if(document.all.contactForm) 				{ 				show('contactForm'); 				}  		}		else if (document.layers) {		  	if(document.contactForm)  				{  				show('contactForm');				}		} 	}}function flipOn(imgName,layerName){if(document.layers){eval("document."+layerName+".document."+imgName).src = "images/"+imgName+"_on.gif";} else if(document.all){eval("document."+imgName).src = "images/"+imgName+"_on.gif";}}function doMenu(state,imgName){divName = imgName.substring(4);layerName = divName.substring(3);layerName = layerName.toLowerCase();if(state){  	if(document.layers){			if (objTimeOut) {clearTimeout(objTimeOut);			toggleOption(1);			}		}  	show(divName);	flipOn(imgName,layerName);}else{	hide(divName);		if(document.layers){			objTimeOut = setTimeout("toggleOption(0)",900);		}}    return true;}function doInit(){ //does all initialization for menuing system //	for(j=1; j<=9; j++){	var color = ((Math.floor(j/2))==(Math.ceil(j/2))) ? 'FF8E28':'FF9A3E';	if(document.layers){ 	// hook functions to mouse events for NS Nav	eval("document.menu"+j+".onmouseover=new Function(\"bgChange('menu"+j+		 "','FFCC00');doMenu(1,'img_subMenu"+j+"');\")");	eval("document.subMenu"+j+".onmouseover=new Function(\"bgChange('menu"+j+		 "','FFCC00');doMenu(1,'img_subMenu"+j+"')\")");eval("document.menu"+j+".onmouseout=new Function(\"bgChange('menu"+j+		 "','#"+color+"');doMenu(0,'img_subMenu"+j+"')\")");	eval("document.subMenu"+j+".onmouseout=new Function(\"bgChange('menu"+j+		 "','#"+color+"');doMenu(0,'img_subMenu"+j+"')\")");		// set bg color for NS Nav hereeval("document.menu"+j+".bgColor='#"+color+"'");eval("document.subMenu"+j+".bgColor='#FFFFFF'");		} else if(document.all){		// set bg color for IE hereeval("document.all.menu"+j+".style.backgroundColor='#"+color+"';");eval("document.all.subMenu"+j+".style.backgroundColor='#FFFFFF';");		}		}}// The following functions were copied from the ones above and//   "Static" added to their names, because the search results and//   "email complete" web pages need static image addresses.function flipOnStatic(imgName,layerName){if(document.layers){eval("document."+layerName+".document."+imgName).src = "images/"+imgName+"_on.gif";} else if(document.all){eval("document."+imgName).src = "images/"+imgName+"_on.gif";}}function doMenuStatic(state,imgName){divName = imgName.substring(4);layerName = divName.substring(3);layerName = layerName.toLowerCase();if(state){  	if(document.layers){			if (objTimeOut) {clearTimeout(objTimeOut);			toggleOption(1);			}		}  	show(divName);	flipOnStatic(imgName,layerName);}else{	hide(divName);		if(document.layers){			objTimeOut = setTimeout("toggleOption(0)",900);		}}    return true;}function doInitStatic(){ //does all initialization for menuing system //	for(j=1; j<=9; j++){	var color = ((Math.floor(j/2))==(Math.ceil(j/2))) ? 'FF8E28':'FF9A3E';	if(document.layers){ 	// hook functions to mouse events for NS Nav	eval("document.menu"+j+".onmouseover=new Function(\"bgChange('menu"+j+		 "','FFCC00');doMenuStatic(1,'img_subMenu"+j+"');\")");	eval("document.subMenu"+j+".onmouseover=new Function(\"bgChange('menu"+j+		 "','FFCC00');doMenuStatic(1,'img_subMenu"+j+"')\")");eval("document.menu"+j+".onmouseout=new Function(\"bgChange('menu"+j+		 "','#"+color+"');doMenuStatic(0,'img_subMenu"+j+"')\")");	eval("document.subMenu"+j+".onmouseout=new Function(\"bgChange('menu"+j+		 "','#"+color+"');doMenuStatic(0,'img_subMenu"+j+"')\")");		// set bg color for NS Nav hereeval("document.menu"+j+".bgColor='#"+color+"'");eval("document.subMenu"+j+".bgColor='#FFFFFF'");		} else if(document.all){		// set bg color for IE hereeval("document.all.menu"+j+".style.backgroundColor='#"+color+"';");eval("document.all.subMenu"+j+".style.backgroundColor='#FFFFFF';");		}		}}// This function is used with onKeyPress for text fields so that a specific//   submit button is selected, rather than the first one on the form.function enter_key_submit(element_to_click)    {    var keycode;    if (window.event)        {        keycode = window.event.keyCode;        }    else if (e)        {        keycode = e.which ;        }    else        {        return true;        }    // if the enter key was pressed.    if (keycode == 13)        {        element_to_click.click();        return false;        }    else        return true;    }// This function is used to skip the navigation links.// It works in Struts environments where the URL displayed to the user is not//    the same URL/URI that the Struts servlet receives//    i.e., Struts request URL ends in layout.jsp//          Browser URL is showDisallowedFunction.do//    Sample://          <a href="javascript:skipNav();"><img src="images/spacer.gif" height="1" width="1" border="0" alt="Navigate to main content"></a>// Note: I am not particularly happy with this function yet, because//    (1) if you use it twice in a row, it keeps appending #main to the end of the URL//    (2) it doesn't work when javascript is disabled// New Note: Andrew found a better way of getting this to work that gets rid of problem #1function goToAnchor(anchor){    window.location.hash = anchor;}